getwd()
input_df <- read.csv("Pregnant_women_all.csv")
input_df <- read.csv("data/Pregnant_women_all.csv")
head(input_df)
install.packages("ggplot2")
str(input_df)
plot(Fee_Amount, Type_facility, data=input_df)
plot(Fee_amount, Type_facility, data=input_df)
plot(input_df$Fee_amount, input_df$Type_facility)
ggplot(input_df, aes(x=Fee_amount, y=Type_facility)) + geom_points()
library(ggplot2)
install.packages("ggplot2")
install.packages("plyr")
install.packages("dplyr")
install.packages("ggplot2", dependencies = TRUE)
library(ggplot2)
install.packages("plyr", dependencies = TRUE)
install.packages("reshape", dependencies = TRUE)
install.packages("plyr", dependencies = TRUE)
install.packages("plyr", repos=NULL)
install.packages("plyr", repos=NULL)
install.packages("plyr", dependencies = TRUE)
install.packages("plyr")
install.packages("ggplot2")
library(ggplot2)
install.packages("ggplot2")
install.packages("ggplot2", dependencies = TRUE)
install.packages("devtools")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2", dependencies = TRUE)
library(ggplot2)
ggplot(input_df, aes(x=Fee_amount, y=Type_facility)) + geom_points()
ggplot(input_df, aes(x=Fee_amount, y=Type_facility)) + geom_point()
str(input_df)
summary(input_df)
switched <- input_df[, c("Age", "House_income", "Months_pregnant", "Number_visits", "Type_facility", "Children",
"First_visit", "Last_visit", "Minutes_doctor", "Minutes_waiting", "Switched_facility")]
str(switched)
summary(switched)
dim(switched)
dim(complete.cases(switched))
complete.cases(switched)
switched[complete.cases(switched),]
dim(switched[complete.cases(switched),])
dim(switched)
swtiched = switched[complete.cases(switched), ]
fit <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=input_df, method="rpart")
install.packages("caret")
library(caret)
fit.lm <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=input_df, method="lm")
fit <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=input_df, method="rpart")
install.packages("e1071")
fit <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=input_df, method="rpart")
install.packages("rattle")
library(rattle)
fit.rpart <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=input_df, method="rpart")
fancyRpartPlot(fit.rpart)
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
fit.rpart <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=input_df, method="rpart")
library(caret)
library(rattle
fit.rpart <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=input_df, method="rpart")
fit.rpart <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=input_df, method="rpart")
library(rattle)
fancyRpartPlot(fit.rpart)
install.packages("rpart.plot")
fancyRpartPlot(fit.rpart)
library(rattle)
fancyRpartPlot(fit.rpart)
plot(fit.rpart)
plot(fit.rpart$finalModel)
fancyRpartPlotfit.rpart$finalModel))
fancyRpartPlot(fit.rpart$finalModel)
fancyRpartPlot(fit.rpart)
fit.rpart <- rpart(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=input_df)
fancyRpartPlot(fit.rpart)
fit.logit <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=input_df, method="logit")
fit.logreg <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=input_df, method="logreg")
fit.logreg <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=input_df, method="logreg")
warnings()
input_df$Switched_facility
input_df <- read.csv("data/Pregnant_women_all.csv", na.strings = "")
str(input_df)
library(ggplot2)
p <- ggplot(input_df, aes(x=Fee_amount, y=Type_facility)) + geom_point()
library(rpart)
library(rattle)
library(caret)
switched <- input_df[, c("Age", "House_income", "Months_pregnant", "Number_visits", "Type_facility", "Children",
"First_visit", "Last_visit", "Minutes_doctor", "Minutes_waiting", "Switched_facility")]
swtiched = switched[complete.cases(switched), ]
fit.rpart <- rpart(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=input_df)
fancyRpartPlot(fit.rpart)
switched = switched[complete.cases(switched), ]
fit.rpart <- rpart(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=switched)
fancyRpartPlot(fit.rpart)
fit.logreg <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=switched, method="logreg")
table(switched$Switched_facility)
fit.rf <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=switched, method="rf")
summary(switched)
fit.rf <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=switched, method="rf")
warnings()
table(switched$Switched_facility)
criteria = switched$Switched_facility == "Yes" | switched$Switched_facility == "No"
criteria
switched = switched[criteria, ]
table(switched$Switched_facility)
factor(switched$Switched_facility)
switched$Switched_facility = factor(switched$Switched_facility)
fit.rpart <- rpart(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=switched)
fancyRpartPlot(fit.rpart)
fit.rf <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=switched, method="rf")
fit.rf
dim(switched)
inTrain <- createDataPartition(switched, p=0.8, list = FALSE)
train <- switched[inTrain, ]
test <- switched[-inTrain, ]
```
inTrain <- createDataPartition(switched$Switched_facility, p=0.8, list = FALSE)
train <- switched[inTrain, ]
test <- switched[-inTrain, ]
dim(switched)
dim(train)
dim(test)
fit.rpart <- rpart(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=train)
fancyRpartPlot(fit.rpart)
#fit.logreg <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
#                  First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=switched, method="logreg")
fit.rf <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=train, method="rf")
fit.rpart
table(train)
table(train$Switched_facility)
fit.rf <- train(Switched_facility ~ Age + House_income + Months_pregnant + Number_visits + Type_facility + Children +
First_visit + Last_visit + Minutes_doctor + Minutes_waiting, data=train, method="rf")
fit.rf
imp <- varImp(fit.rf)
imp
plot(imp)
colnames(test)
predict.rf <- predict(fit.rf, newdata=test[, -11])
conf.rf <- confidenceMatrix(predict.rf, test$Switched_facility)
conf.rf <- confusionMatrix(predict.rf, test$Switched_facility)
conf.rf
View(data.frame(predict.rf, test$Switched_facility))
step(fit.rf, ~.^2)
